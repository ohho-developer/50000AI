{% extends "recipe_ai/base.html" %}

{% block title %}{% if post %}게시글 수정{% else %}게시글 작성{% endif %} - 커뮤니티{% endblock %}

{% block content %}
<div class="min-h-screen bg-black">
<div class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- 뒤로가기 -->
    <div class="mb-6">
        <a href="{% if post %}{% url 'recipe_ai:community_detail' post.id %}{% else %}{% url 'recipe_ai:community_list' %}{% endif %}" 
           class="inline-flex items-center text-orange-500 hover:text-orange-400 transition-colors">
            <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            {% if post %}게시글로{% else %}목록으로{% endif %}
        </a>
    </div>

    <!-- 폼 -->
    <div class="bg-gray-800/50 backdrop-blur-sm rounded-lg border border-gray-700/50 shadow-lg p-8">
        <h1 class="text-2xl font-bold text-white mb-6">
            {% if post %}게시글 수정{% else %}게시글 작성{% endif %}
        </h1>

        <form method="POST" class="space-y-6">
            {% csrf_token %}

            <!-- 카테고리 -->
            <div>
                <label for="category" class="block text-sm font-medium text-gray-300 mb-2">
                    카테고리 <span class="text-red-400">*</span>
                </label>
                <select 
                    name="category" 
                    id="category" 
                    required
                    class="w-full px-4 py-3 rounded-lg bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-colors"
                >
                    {% for value, label in categories %}
                    <option value="{{ value }}" {% if post and post.category == value or category == value %}selected{% endif %}>
                        {{ label }}
                    </option>
                    {% endfor %}
                </select>
            </div>

            <!-- 제목 -->
            <div>
                <label for="title" class="block text-sm font-medium text-gray-300 mb-2">
                    제목 <span class="text-red-400">*</span>
                </label>
                <input 
                    type="text" 
                    name="title" 
                    id="title" 
                    value="{% if post %}{{ post.title }}{% else %}{{ title }}{% endif %}"
                    required
                    maxlength="200"
                    placeholder="제목을 입력하세요"
                    class="w-full px-4 py-3 rounded-lg bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-colors"
                >
                <p class="mt-1 text-sm text-gray-400">
                    최대 200자
                </p>
            </div>

            <!-- 내용 -->
            <div>
                <label for="content" class="block text-sm font-medium text-gray-300 mb-2">
                    내용 <span class="text-red-400">*</span>
                </label>
                <textarea 
                    name="content" 
                    id="content" 
                    rows="15" 
                    required
                    placeholder="내용을 입력하세요&#10;&#10;• 서로 존중하는 커뮤니티 문화를 만들어주세요&#10;• 개인정보나 민감한 정보는 공유하지 마세요&#10;• 도움이 되는 정보를 공유해주세요"
                    class="w-full px-4 py-3 rounded-lg bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-colors resize-none"
                >{% if post %}{{ post.content }}{% else %}{{ content }}{% endif %}</textarea>
                <p class="mt-1 text-sm text-gray-400">
                    마크다운 문법을 지원하지 않습니다. 일반 텍스트로 작성해주세요.
                </p>
            </div>

            <!-- 안내 메시지 -->
            <div class="bg-orange-500/10 border border-orange-500/30 rounded-lg p-4">
                <div class="flex items-start">
                    <svg class="w-5 h-5 text-orange-400 mt-0.5 mr-3" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                    </svg>
                    <div class="text-sm text-orange-300">
                        <p class="font-medium mb-1">커뮤니티 가이드라인</p>
                        <ul class="list-disc list-inside space-y-1 text-gray-400">
                            <li>다른 사용자를 존중하고 배려하는 글을 작성해주세요</li>
                            <li>광고성 게시글은 삭제될 수 있습니다</li>
                            <li>욕설, 비방, 혐오 표현은 금지됩니다</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- 버튼 -->
            <div class="flex justify-end gap-3 pt-4 border-t border-gray-700/50">
                <a 
                    href="{% if post %}{% url 'recipe_ai:community_detail' post.id %}{% else %}{% url 'recipe_ai:community_list' %}{% endif %}" 
                    class="px-6 py-3 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 border border-gray-600 transition-colors font-medium"
                >
                    취소
                </a>
                <button 
                    type="submit" 
                    class="px-6 py-3 bg-gradient-to-r from-orange-600 to-orange-500 text-white rounded-lg hover:from-orange-700 hover:to-orange-600 transition-colors font-medium shadow-lg shadow-orange-500/30"
                >
                    {% if post %}수정하기{% else %}작성하기{% endif %}
                </button>
            </div>
        </form>
    </div>
</div>
</div>
{% endblock %}
